<html>
	<head>
		<title>FistiCode</title>
		<script type="text/javascript" src="lib/underscore.js"></script>
		<script type="text/javascript" src="lib/jquery-1.6.1.min.js"></script>
		<script type="text/javascript" src="lib/Sandbox.min.js"></script>
		<script type="text/javascript" src="main.js"></script>
		<script type="text/javascript" src="constants.js"></script>
		<script type="text/javascript" src="util.js"></script>

		<script type="text/javascript" src="game/action.js"></script>
		<script type="text/javascript" src="game/weapon.js"></script>
		<script type="text/javascript" src="game/player.js"></script>
		<script type="text/javascript" src="game/team.js"></script>
		<script type="text/javascript" src="game/map.js"></script>
		<script type="text/javascript" src="game/projectile.js"></script>
		<script type="text/javascript" src="game/game.js"></script>

		<script type="text/javascript" src="controller/player_controller.js"></script>
		<script type="text/javascript" src="controller/game_controller.js"></script>
		<script type="text/javascript" src="controller/weapon_controller.js"></script>

		<script type="text/javascript" src="renderer/map_renderer.js"></script>
		<script type="text/javascript" src="renderer/player_renderer.js"></script>
		<script type="text/javascript" src="renderer/game_renderer.js"></script>
		<script type="text/javascript">
			var fc = FistiCode;

			$(function() {
					var gun = fc._create_weapon();

					var red_1 = fc._create_player({}, {weapon: fc._create_weapon()});

					var red = fc._create_team([red_1]);

					var blue_1 = fc._create_player();

					var blue = fc._create_team([blue_1]);

					var map = fc._create_map();

					var game = fc._create_live_game({
								teams: [red, blue],
								map: map});


					game.initialize();
					game.run();

					var controller = game.get_player_controller(red_1);
					/*


					var controller_1 = game.get_player_controller(red_1);

					var ctx = $("canvas#sample_match")[0].getContext("2d");
					fc._draw_game(game, ctx);
					window.timeout = 50;
					(function() {
						fc._draw_game(game, ctx);
						window.setTimeout(arguments.callee, window.timeout);
					 })();

					window.controller = controller_1;
						controller_1.fire();

					//controller.rotateClockwise();

					controller.moveBackward();
					window.game = game;
					*/

					$("a#run").click(function() {
							var sandbox = new Sandbox();
							sandbox.global.player = controller;
							sandbox.global.console = console;
							var text = $("textarea#text").attr("value");

							var ctx = $("canvas#sample_match")[0].getContext("2d");
							fc._draw_game(game, ctx);
							window.timeout = 50;
							(function() {
								fc._draw_game(game, ctx);
								window.setTimeout(arguments.callee, window.timeout);
							 })();

							sandbox.eval(text);
							});

					$("a#run").click();
			});

		</script>
	</head>
	<body>
		<canvas width = "500" height="500" id="sample_match"></canvas>
		<textarea style="height: 500px; width: 400px;" id="text">
player.moveForward();

player.rotateClockwise();
player.fire();
console.log(player.getInfo());
		</textarea>
		<a href="javascript:void(0)" id="run">Run</a>
	</body>
</html>
